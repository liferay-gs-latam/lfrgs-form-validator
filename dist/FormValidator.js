!function(e){var t={};function i(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=3)}([function(e,t){const i=e=>"object"==typeof e&&!Array.isArray(e),s=e=>e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),a=(e,t)=>{const s={...t};if([null,void 0].includes(s))return e;const n=Object.keys(e);for(let t=0;t<n.length;t+=1){const r=n[t];i(e[r])&&i(s[r])?s[r]=a(e[r],s[r]):s[r]=e[r]}return s},n=(e,t)=>{t=t.split(".");for(let i=0;i<t.length;i+=1){if([null,void 0].includes(e))return;e=e[t[i]]}return e},r=e=>Array.isArray(e)?(e=>{const t=[];for(let i=0;i<e;i+=1)t.push(i);return t})(e.length):Object.keys(e),l=(e={},t="{}",i=2)=>({in:(...a)=>{const o=s(t[0]||"").repeat(i),d=s(t[1]||"").repeat(i),h=[];for(let s=0;s<a.length;s+=1){const u=Array.isArray(a[s])?[...a[s]]:{...a[s]},c=r(u);for(let s=0;s<c.length;s+=1){const a=c[s];"object"==typeof u[a]?[u[a]]=l(e,t,i).in(u[a]):"string"==typeof u[a]&&(u[a]=u[a].replace(new RegExp(`${o}[^${o}]*${d}`,"g"),t=>{const i=t.replace(new RegExp(`${o} *| *${d}`,"g"),"");return n(e,i)}))}h.push(u)}return h}});e.exports={deepSpread:a,inject:e=>({to:t=>a(e,t)}),injectN:e=>{const t=(i=e)=>e=>(result=a(i,e),{result:result,to:t(result)});return{result:e,to:t()}},replace:l}},function(e,t,i){var s,a;void 0===(a="function"==typeof(s=function(){var e=[9,16,17,18,36,37,38,39,40,91,92,93],t=function(e){return(e={delimiter:(e=e||{}).delimiter||".",lastOutput:e.lastOutput,precision:e.hasOwnProperty("precision")?e.precision:2,separator:e.separator||",",showSignal:e.showSignal,suffixUnit:e.suffixUnit&&" "+e.suffixUnit.replace(/[\s]/g,"")||"",unit:e.unit&&e.unit.replace(/[\s]/g,"")+" "||"",zeroCents:e.zeroCents}).moneyPrecision=e.zeroCents?0:e.precision,e},i=function(e,t,i){for(;t<e.length;t++)"9"!==e[t]&&"A"!==e[t]&&"S"!==e[t]||(e[t]=i);return e},s=function(e){this.elements=e};s.prototype.unbindElementToMask=function(){for(var e=0,t=this.elements.length;e<t;e++)this.elements[e].lastOutput="",this.elements[e].onkeyup=!1,this.elements[e].onkeydown=!1,this.elements[e].value.length&&(this.elements[e].value=this.elements[e].value.replace(/\D/g,""))},s.prototype.bindElementToMask=function(t){for(var i=this,s=function(s){var n=(s=s||window.event).target||s.srcElement;(function(t){for(var i=0,s=e.length;i<s;i++)if(t==e[i])return!1;return!0})(s.keyCode)&&setTimeout((function(){i.opts.lastOutput=n.lastOutput,n.value=a[t](n.value,i.opts),n.lastOutput=n.value,n.setSelectionRange&&i.opts.suffixUnit&&n.setSelectionRange(n.value.length,n.value.length-i.opts.suffixUnit.length)}),0)},n=0,r=this.elements.length;n<r;n++)this.elements[n].lastOutput="",this.elements[n].onkeyup=s,this.elements[n].value.length&&(this.elements[n].value=a[t](this.elements[n].value,this.opts))},s.prototype.maskMoney=function(e){this.opts=t(e),this.bindElementToMask("toMoney")},s.prototype.maskNumber=function(){this.opts={},this.bindElementToMask("toNumber")},s.prototype.maskAlphaNum=function(){this.opts={},this.bindElementToMask("toAlphaNumeric")},s.prototype.maskPattern=function(e){this.opts={pattern:e},this.bindElementToMask("toPattern")},s.prototype.unMask=function(){this.unbindElementToMask()};var a=function(e){if(!e)throw new Error("VanillaMasker: There is no element to bind.");var t="length"in e?e.length?e:[]:[e];return new s(t)};return a.toMoney=function(e,i){if((i=t(i)).zeroCents){i.lastOutput=i.lastOutput||"";var s="("+i.separator+"[0]{0,"+i.precision+"})",a=new RegExp(s,"g"),n=e.toString().replace(/[\D]/g,"").length||0,r=i.lastOutput.toString().replace(/[\D]/g,"").length||0;e=e.toString().replace(a,""),n<r&&(e=e.slice(0,e.length-1))}for(var l=e.toString().replace(/[\D]/g,""),o=new RegExp("^(0|\\"+i.delimiter+")"),d=new RegExp("(\\"+i.separator+")$"),h=l.substr(0,l.length-i.moneyPrecision),u=h.substr(0,h.length%3),c=new Array(i.precision+1).join("0"),p=0,f=(h=h.substr(h.length%3,h.length)).length;p<f;p++)p%3==0&&(u+=i.delimiter),u+=h[p];u=(u=u.replace(o,"")).length?u:"0";var m="";if(!0===i.showSignal&&(m=e<0||e.startsWith&&e.startsWith("-")?"-":""),!i.zeroCents){var g=l.length-i.precision,v=l.substr(g,i.precision),b=v.length,F=i.precision>b?i.precision:b;c=(c+v).slice(-F)}return(i.unit+m+u+i.separator+c).replace(d,"")+i.suffixUnit},a.toPattern=function(e,t){var s,a="object"==typeof t?t.pattern:t,n=a.replace(/\W/g,""),r=a.split(""),l=e.toString().replace(/\W/g,""),o=l.replace(/\W/g,""),d=0,h=r.length,u="object"==typeof t?t.placeholder:void 0;for(s=0;s<h;s++){if(d>=l.length){if(n.length==o.length)return r.join("");if(void 0!==u&&n.length>o.length)return i(r,s,u).join("");break}if("9"===r[s]&&l[d].match(/[0-9]/)||"A"===r[s]&&l[d].match(/[a-zA-Z]/)||"S"===r[s]&&l[d].match(/[0-9a-zA-Z]/))r[s]=l[d++];else if("9"===r[s]||"A"===r[s]||"S"===r[s])return void 0!==u?i(r,s,u).join(""):r.slice(0,s).join("")}return r.join("").substr(0,s)},a.toNumber=function(e){return e.toString().replace(/(?!^-)[^0-9]/g,"")},a.toAlphaNumeric=function(e){return e.toString().replace(/[^a-z0-9 ]+/i,"")},a})?s.call(t,i,t,e):s)||(e.exports=a)},function(e,t,i){var s=function(e){"use strict";var t=Object.prototype,i=t.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",n=s.asyncIterator||"@@asyncIterator",r=s.toStringTag||"@@toStringTag";function l(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,i){return e[t]=i}}function o(e,t,i,s){var a=t&&t.prototype instanceof u?t:u,n=Object.create(a.prototype),r=new _(s||[]);return n._invoke=function(e,t,i){var s="suspendedStart";return function(a,n){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===a)throw n;return A()}for(i.method=a,i.arg=n;;){var r=i.delegate;if(r){var l=y(r,i);if(l){if(l===h)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===s)throw s="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);s="executing";var o=d(e,t,i);if("normal"===o.type){if(s=i.done?"completed":"suspendedYield",o.arg===h)continue;return{value:o.arg,done:i.done}}"throw"===o.type&&(s="completed",i.method="throw",i.arg=o.arg)}}}(e,i,r),n}function d(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=o;var h={};function u(){}function c(){}function p(){}var f={};l(f,a,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(w([])));g&&g!==t&&i.call(g,a)&&(f=g);var v=p.prototype=u.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function F(e,t){var s;this._invoke=function(a,n){function r(){return new t((function(s,r){!function s(a,n,r,l){var o=d(e[a],e,n);if("throw"!==o.type){var h=o.arg,u=h.value;return u&&"object"==typeof u&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){s("next",e,r,l)}),(function(e){s("throw",e,r,l)})):t.resolve(u).then((function(e){h.value=e,r(h)}),(function(e){return s("throw",e,r,l)}))}l(o.arg)}(a,n,s,r)}))}return s=s?s.then(r,r):r()}}function y(e,t){var i=e.iterator[t.method];if(void 0===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,y(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var s=d(i,e.iterator,t.arg);if("throw"===s.type)return t.method="throw",t.arg=s.arg,t.delegate=null,h;var a=s.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function w(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,n=function t(){for(;++s<e.length;)if(i.call(e,s))return t.value=e[s],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:A}}function A(){return{value:void 0,done:!0}}return c.prototype=p,l(v,"constructor",p),l(p,"constructor",c),c.displayName=l(p,r,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===c||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,r,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},b(F.prototype),l(F.prototype,n,(function(){return this})),e.AsyncIterator=F,e.async=function(t,i,s,a,n){void 0===n&&(n=Promise);var r=new F(o(t,i,s,a),n);return e.isGeneratorFunction(i)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},b(v),l(v,r,"Generator"),l(v,a,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var s=t.pop();if(s in e)return i.value=s,i.done=!1,i}return i.done=!0,i}},e.values=w,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function s(i,s){return r.type="throw",r.arg=e,t.next=i,s&&(t.method="next",t.arg=void 0),!!s}for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a],r=n.completion;if("root"===n.tryLoc)return s("end");if(n.tryLoc<=this.prev){var l=i.call(n,"catchLoc"),o=i.call(n,"finallyLoc");if(l&&o){if(this.prev<n.catchLoc)return s(n.catchLoc,!0);if(this.prev<n.finallyLoc)return s(n.finallyLoc)}else if(l){if(this.prev<n.catchLoc)return s(n.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return s(n.finallyLoc)}}}},abrupt:function(e,t){for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var n=a;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var r=n?n.completion:{};return r.type=e,r.arg=t,n?(this.method="next",this.next=n.finallyLoc,h):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),E(i),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var s=i.completion;if("throw"===s.type){var a=s.arg;E(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:w(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},e}(e.exports);try{regeneratorRuntime=s}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=s:Function("r","regeneratorRuntime = r")(s)}},function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return B})),i.d(t,"FormValidatorStepsHandler",(function(){return $}));i(2);const s="data-form-validator-initialized-field",a="data-form-validator-group-wrapper",n="data-form-validator-repeatable-wrapper",r="data-form-validator-repeatable-limit",l="data-form-validator-repeatable-item",o={debug:!1,enableDataRestore:!1,resetFieldValidationOnChange:!0,validateFieldOnInput:!1,validateFieldOnBlur:!0,validateFieldOnChange:!1,formDisabledClass:"disabled",formEnabledClass:"",groupWrapperHiddenClass:"d-none",groupWrapperVisibleClass:"d-block",fieldRenderPreferences:{wrapperClass:"form-group",wrapperHiddenClass:"d-none",wrapperVisibleClass:"d-block",wrapperDisabledClass:"disabled",messageWrapperNode:void 0,disabledClass:"disabled",showUnvalidatedMessage:!1,unvalidatedMessage:"Unvalidated",unvalidatedMessageHTML:'<div class="valid-feedback text-muted d-block">{{message}}</div>',addUnvalidatedClass:!0,unvalidatedClass:"is-unvalidated",addWrapperUnvalidatedClass:!0,wrapperUnvalidatedClass:"is-unvalidated",messageUnvalidatedClass:"is-unvalidated",showValidatingMessage:!0,validatingMessage:"Validating...",validatingMessageHTML:'<div class="valid-feedback text-muted d-block">{{message}}</div>',addValidatingClass:!0,validatingClass:"is-validating",addWrapperValidatingClass:!0,wrapperValidatingClass:"is-validating",messageValidatingClass:"is-validating",showInvalidMessage:!0,invalidMessageHTML:'<div class="invalid-feedback text-danger d-block">{{message}}</div>',addInvalidClass:!0,invalidClass:"is-invalid",addWrapperInvalidClass:!0,wrapperInvalidClass:"is-invalid",messageInvalidClass:"is-invalid",showValidMessage:!0,validMessage:"Field is valid",validMessageHTML:'<div class="valid-feedback text-success d-block">{{message}}</div>',addValidClass:!0,validClass:"is-valid",addWrapperValidClass:!0,wrapperValidClass:"is-valid"},fields:[],showLoadingFn:void 0,hideLoadingFn:void 0,submitFn:void 0,events:{onInit:void 0,onBeforeReset:void 0,onReset:void 0,onTrySubmit:void 0,onBeforeSubmit:void 0,onSubmitFail:void 0,onSubmit:void 0,onBeforeValidate:void 0,onValidate:void 0,onBeforeValidateField:void 0,onValidateField:void 0,onFieldInput:void 0,onBeforeShowDependentFields:void 0,onShowDependentFields:void 0,onBeforeHideDependentFields:void 0,onHideDependentFields:void 0}};var d={INITIALIZED_FIELD_DATA_ATTRIBUTE:s,GROUP_WRAPPER_DATA_ATTRIBUTE:a,DEFAULT_OPTIONS:o,REPEATABLE_WRAPPER_DATA_ATTRIBUTE:n,REPEATABLE_LIMIT_DATA_ATTRIBUTE:r,REPEATABLE_ITEM_DATA_ATTRIBUTE:l},h={name:"required",parameter:null,message:"Campo obrigatório",async:!1,fn:(e,t)=>t&&t.length>0?"money"===t?e&&e.length>0&&"0"!=e&&"0,00"!=e:e&&e.length>0&&e!==t:e&&e.length>0},u={name:"length",parameter:null,message:"Quantidade de itens inválida",async:!1,fn:(e,t)=>!t||e.length===t},c={name:"minLength",parameter:null,message:"Valor pequeno demais",async:!1,fn:(e,t)=>!t||e.length>=t},p={name:"maxLength",parameter:null,message:"Valor grande demais",async:!1,fn:(e,t)=>!t||e.length<=Number(t)},f={name:"regex",parameter:null,message:"Valor inválido",async:!1,fn:(e,t)=>{if(!t)return!0;let i=!0;var s=new RegExp(t);return e.forEach(e=>{s.test(e)||(i=!1)}),i}},m={name:"email",parameter:null,message:"Invalid email address",async:!1,fn:(e,t)=>/[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e)||!e.length},g={name:"equal",parameter:null,message:"Campo inválido",async:!1,fn:(e,t)=>{let i=!0;return"object"==typeof t?t.forEach(s=>{e.includes(s)||(i=!1),t.length!==e.length&&(i=!1)}):e!==t&&(i=!1),i}},v={name:"hasValues",parameter:null,message:"Campo inválido",async:!1,fn:(e,t)=>{let i=!0;return"object"==typeof t?(0===t.length&&(i=!1),t.forEach(t=>{e.includes(t)||(i=!1)})):e.includes(t)&&(i=!0),i}},b={name:"cpf",parameter:null,message:"CPF inválido",async:!1,fn:e=>function(e){if("string"!=typeof e)return!1;if(11!==(e=e.replace(/[\s.-]*/gim,"")).length||!Array.from(e).filter(t=>t!==e[0]).length)return!1;for(var t,i=0,s=1;s<=9;s++)i+=parseInt(e.substring(s-1,s))*(11-s);if(10!=(t=10*i%11)&&11!=t||(t=0),t!=parseInt(e.substring(9,10)))return!1;for(i=0,s=1;s<=10;s++)i+=parseInt(e.substring(s-1,s))*(12-s);return 10!=(t=10*i%11)&&11!=t||(t=0),t==parseInt(e.substring(10,11))}(e)},F={name:"cep",parameter:null,message:"CEP inválido",async:!1,fn:e=>/^[0-9]{5}-[0-9]{3}|[0-9]{8}$/.test(e)},y={name:"date",parameter:null,message:"Data inválida",async:!1,fn:(e,t)=>/^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[13-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/.test(e)},S={name:"phone",parameter:null,message:"Telefone inválido",async:!1,fn:(e,t)=>{if(e.length){return/^((\d{3}).(\d{3}).(\d{3})-(\d{2}))*$/.test(e)}return!0}},E={name:"age",parameter:18,message:"Idade insuficiente",async:!1,fn:(e,t)=>{const i=(new Date).getFullYear(),s=e.substring(6),a=e.substring(3,5),n=e.slice(0,2);if(i-s<Number(t))return!1;if(i-s>Number(t))return!0;if(i-s==Number(t)){if(actualMonth>a)return!0;if(actualMonth<a)return!1;if(actualMonth==a){if(actualDay>n||actualDay==n)return!0;if(actualDay<n)return!1}}}},_={name:"fullName",parameter:null,message:"Nome incompleto",async:!1,fn:e=>/^([a-zA-Z]{2,}\s[a-zA-Z]{1,}'?-?[a-zA-Z]{2,}\s?([a-zA-Z]{1,})?)/.test(e)},w={required:h,minLength:c,maxLength:p,regex:f,email:m,equal:g,hasValues:v,cpf:b,cep:F,date:y,phone:S,length:u,age:E,fullName:_};class A{constructor(e){return this.name=e.name,this.parameter=e.parameter,this.message=e.message,this.async=e.async,this.fn=e.fn,this}test(e){var t=this.message;return new Promise((i,s)=>{void 0===this.fn?i():!0===this.async?this.fn(e,this.parameter,(function(e){e?i():s(t)})):this.fn(e,this.parameter)?i():s(t)})}}class V{constructor(e=!1){this.showLogs=!!e}log(e,t){if(!this.showLogs)return;let i=t||"";console.log(e,i)}logWarning(e,t){if(!this.showLogs)return;let i=t||"";console.warn(e,i)}logError(e,t){let i=t||"";console.error(e,i)}}var I=V,C=i(1),L=i.n(C),R=i(0);const T=e=>(new DOMParser).parseFromString(e.trim(),"text/html").body.firstChild,O=e=>(Object.keys(e).forEach(t=>{void 0===e[t]&&delete e[t]}),e);class D{constructor(e,t=!1){this._logger=new I(t),e._validator.$form.querySelectorAll('[name="'+e.name+'"]').length&&(this._validator=e._validator,this.name=e.name,this.group=e.group,this.elements=Array.from(e._validator.$form.querySelectorAll('[name="'+e.name+'"]')),this.interactive=void 0===e.interactive||e.interactive,this.mask=e.mask,this.dependencyRules=e.dependencyRules,this.useRules=void 0===e.useRules||e.useRules,this.rules=e.rules||[],this.events=e.events,this.fieldRenderPreferences=e.fieldRenderPreferences,this.resetFieldValidationOnChange=e.resetFieldValidationOnChange,this.validateFieldOnInput=e.validateFieldOnInput,this.validateFieldOnBlur=e.validateFieldOnBlur,this.validateFieldOnChange=e.validateFieldOnChange,this._disabled=!1,this.disabled=void 0!==e.disabled&&e.disabled,this.getValueFn=e.getValueFn,this.setValueFn=e.setValueFn,this.focusFn=e.focusFn,this.disableFn=e.disableFn,this.enableFn=e.enableFn,this.formResetFn=e.formResetFn,this.helpText=e.helpText,this.register())}getFieldRenderPreferences(){let e=this._validator.fieldRenderPreferences;return void 0!==this.fieldRenderPreferences&&(e=Object(R.deepSpread)(this.fieldRenderPreferences,this._validator.fieldRenderPreferences)),e}getEvents(){let e;return e=void 0!==this.events?{...this._validator.events,...O(this.events)}:this._validator.events,e}getOptionFromFieldOrRoot(e){return void 0===this[e]?this._validator[e]?this._validator[e]:void 0:this[e]}register(){if(this.registered)return;var e=[];this.registered=!0,this.status=void 0,this._status=void 0,this.message=void 0,this.validationAppendedElements=[];var t=this.getFieldRenderPreferences();t.wrapperClass&&t.wrapperClass.length?this.$wrapper=this.elements[0].closest("."+t.wrapperClass):this.$wrapper=void 0;let i=this.getEvents();return this.elements.forEach(t=>{t.setAttribute(d.INITIALIZED_FIELD_DATA_ATTRIBUTE,"true"),t.hasAttribute("readonly")&&t.setAttribute("data-originally-readonly",""),t.hasAttribute("disabled")&&(this.disabled=!0);let s=!1;"radio"!==t.getAttribute("type")&&"checkbox"!==t.getAttribute("type")||(s=!0);let a=!1;"select"===t.tagName.toLowerCase()&&(a=!0);let n=!1;"file"===t.tagName.toLowerCase()&&(n=!0);let r=!1;t.hasAttribute("type")&&"hidden"===t.getAttribute("type")&&(r=!0);let l=e=>{if(this._validator.hasChangedSinceLastSubmission=!0,this.status=void 0,this._status=void 0,(this.getOptionFromFieldOrRoot("resetFieldValidationOnChange")||(a||n)&&this.getOptionFromFieldOrRoot("validateFieldOnBlur"))&&this.setUnvalidated(),(a||n)&&this.getOptionFromFieldOrRoot("validateFieldOnBlur")){(()=>{this._validate().then(e=>{}).catch(e=>{}).finally(()=>{t.focus()})})()}i&&i.onFieldInput&&i.onFieldInput(this)};var o;let h=()=>{if(this.getOptionFromFieldOrRoot("validateFieldOnBlur")&&this.interactive){let e=()=>{this._validate().then(e=>{}).catch(e=>{})};clearTimeout(o),o=setTimeout(e,1),e()}};var u;let c=()=>{if(this._validator.hasChangedSinceLastSubmission=!0,(this.getOptionFromFieldOrRoot("validateFieldOnChange")||s&&this.getOptionFromFieldOrRoot("validateFieldOnBlur"))&&this.interactive){let e=()=>{this._validate().then(e=>{}).catch(e=>{}).finally(()=>{t.focus()})};clearTimeout(u),u=setTimeout(e,1)}i&&i.onFieldChange&&i.onFieldChange(this)};t.addEventListener("input",l),t.addEventListener("change",c),t.addEventListener("blur",h),t.addEventListener("focus",()=>{i&&i.onFieldFocus&&i.onFieldFocus(this)}),e.push(()=>{t.removeEventListener("input",l),t.removeEventListener("change",c),t.removeEventListener("blur",h),t.removeAttribute(d.INITIALIZED_FIELD_DATA_ATTRIBUTE)})}),this.mask&&this.setMask(this.mask),this.disabled&&this.disable(!1),this.unregister=()=>{this.setUnvalidated(),e.forEach(e=>{e()}),this.unsetMask(),this.registered=!1,delete this._validator.fields[this.name]},this}getValue(){if(this.getValueFn&&"function"==typeof this.getValueFn)return this.getValueFn(this);if(this.elements.length>1){let e=[];return"radio"!==this.elements[0].getAttribute("type")&&"checkbox"!==this.elements[0].getAttribute("type")||this.elements.forEach(t=>{t.checked&&e.push(t.value)}),0===e.length?"":1===e.length?e[0]:e}return"radio"===this.elements[0].getAttribute("type")||"checkbox"===this.elements[0].getAttribute("type")?this.elements[0].checked?this.elements[0].value:"":this.elements[0].value}setValue(e){if(this.setValueFn&&"function"==typeof this.setValueFn){this.setValueFn(this,e);this._validator.updateDependencyRules()}else"object"==typeof e?this.elements.forEach((t,i)=>{"radio"===t.getAttribute("type")||"checkbox"===t.getAttribute("type")?e.includes(t.value)?t.checked=!0:t.checked=!1:(e[i]||(e[i]=""),t.value=e[i])}):this.elements.forEach((t,i)=>{"radio"===t.getAttribute("type")||"checkbox"===t.getAttribute("type")?e===t.value?t.checked=!0:t.checked=!1:(e||(e=""),t.value=e)}),this._validator.updateDependencyRules();this.mask&&this.setMask(this.mask),this._validator.hasChangedSinceLastSubmission=!0}isValid(){return!this.useRules||void 0!==this._status&&1===this._status}disableRules(){this.useRules=!1}enableRules(){this.useRules=!0}getRules(){let e=[];return this.rules.forEach(t=>{"string"==typeof t&&(t=-1!==t.indexOf(":")?{name:t.split(":")[0],parameter:t.split(":")[1]}:{name:t}),this._validator.defaultRules[t.name]&&(t={...this._validator.defaultRules[t.name],...O(t)});let i=new A(t);e.push(i)}),e}setMask(e){if(e||(e=this.mask),!e)return;let t=this.elements.filter(e=>e&&document.body.contains(e));this.unsetMask(),"money"===e?L()(t).maskMoney({precision:2,separator:",",delimiter:".",zeroCents:!1}):L()(t).maskPattern(e)}unsetMask(){let e=this.elements.filter(e=>e&&document.body.contains(e));e.length&&L()(e)&&L()(e).unMask()}handlePreventingDefault(e){e.preventDefault()}disable(e=!0){if(!this._disabled){var t=this.getFieldRenderPreferences();t.wrapperDisabledClass&&this.$wrapper.classList.add(t.wrapperDisabledClass),this._disabled=!0,this.disableInteraction(),this.elements.forEach(e=>{t.disabledClass&&e.classList.add(t.disabledClass),e.setAttribute("disabled","disabled")}),e&&this.setUnvalidated(),this.disableFn&&this.disableFn(this)}}enable(e=!0){if(!this.disabled&&this._disabled){var t=this.getFieldRenderPreferences();t.wrapperDisabledClass&&this.$wrapper.classList.remove(t.wrapperDisabledClass),this._disabled=!1,this.enableInteraction(),this.elements.forEach(e=>{t.disabledClass&&e.classList.remove(t.disabledClass),e.removeAttribute("disabled")}),e&&this.setUnvalidated(),this.enableFn&&this.enableFn(this)}}disableInteraction(){this.interactive&&(this.elements.forEach(e=>{e.setAttribute("readonly","readonly"),e.addEventListener("input",this.handlePreventingDefault),e.addEventListener("click",this.handlePreventingDefault)}),this.disableInteractionFn&&this.disableInteractionFn(this),this.interactive=!1)}enableInteraction(){this.interactive||this.disabled||this._disabled||(this.elements.forEach(e=>{e.hasAttribute("data-originally-readonly")||e.removeAttribute("readonly"),e.removeEventListener("input",this.handlePreventingDefault),e.removeEventListener("click",this.handlePreventingDefault)}),this.enableInteractionFn&&this.enableInteractionFn(this),this.interactive=!0)}focus(){this.elements[0].focus(),this.focusFn&&this.focusFn(),this.$wrapper.dispatchEvent(new CustomEvent("formValidatorFieldFocus",{detail:{formValidatorField:this}}))}_setFieldValidationStatus(e,t,i=!1){var s=e.charAt(0).toUpperCase()+e.slice(1);if("validating"===e?(this._status=-1,this.disableInteraction(),i||(this.status=-1)):"valid"===e?(this._status=1,this.enableInteraction(),i||(this.status=1)):"invalid"===e?(this._status=0,this.enableInteraction(),i||(this.status=0)):(this._status=void 0,this.enableInteraction(),i||(this.status=void 0)),this.message=t,!i){this.removeValidationAppendedElements();var a=this.getFieldRenderPreferences();if(a["add"+s+"Class"]&&this.elements.forEach(t=>{"object"==typeof this.getValue()&&this.getValue().length>0?this.getValue().includes(t.value)&&t.classList.add(a[e+"Class"]):t.classList.add(a[e+"Class"])}),a["addWrapper"+s+"Class"]&&this.$wrapper.classList.add(a["wrapper"+s+"Class"]),a["show"+s+"Message"]&&t){if(this.message="function"==typeof t?t():t,!t.length)return;let i=a[e+"MessageHTML"].replace("{{message}}",t),n=T(i);a["message"+s+"Class"]&&n.classList.add(a["message"+s+"Class"]),a.messageWrapperNode?a.messageWrapperNode.appendChild(n):a.messageWrapperNodeId&&document.getElementById(a.messageWrapperNodeId)?document.getElementById(a.messageWrapperNodeId).appendChild(n):this.$wrapper.appendChild(n),this.validationAppendedElements.push(n)}}}setUnvalidated(e,t){e&&e.length||(e=this.getFieldRenderPreferences().unvalidatedMessage),this._setFieldValidationStatus("unvalidated",e,t)}setValidating(e,t){this._setFieldValidationStatus("validating",e,t)}setValid(e,t){this._setFieldValidationStatus("valid",e,t)}setInvalid(e,t){this._setFieldValidationStatus("invalid",e,t)}resetValidation(e){this.setUnvalidated(e)}removeValidationAppendedElements(){let e=this.getFieldRenderPreferences();this.$wrapper.classList.remove(e.wrapperUnvalidatedClass),this.elements.forEach(t=>{t.classList.remove(e.unvalidatedClass)}),this.$wrapper.classList.remove(e.wrapperValidatingClass),this.elements.forEach(t=>{t.classList.remove(e.validatingClass)}),this.$wrapper.classList.remove(e.wrapperValidClass),this.elements.forEach(t=>{t.classList.remove(e.validClass)}),this.$wrapper.classList.remove(e.wrapperInvalidClass),this.elements.forEach(t=>{t.classList.remove(e.invalidClass)}),this.validationAppendedElements.forEach(e=>{e.remove()}),this.validationAppendedElements=[]}validate(e=(()=>{})){this._validate().then(t=>{e(!0)}).catch(t=>{e(!1)})}_validate(e=!1){var t=this.getFieldRenderPreferences();let i=t.validatingMessage,s=t.validMessage;if(!this.useRules)return new Promise((e,t)=>{e()});if(-1===this._status)return this._logger.logWarning('validate(): Field "#'+this.name+'" is still being validated'),new Promise((t,s)=>{this.setValidating(i,e),s()});if(1===this._status||0===this._status){let t=this._status;return this._logger.logWarning('validate(): Field "#'+this.name+"\" hasn't changed since last validation"),new Promise((i,a)=>{1===t?(this.setValid(s,e),i()):(this.setInvalid(this.message,e),a())})}this._logger.log('validate(): Field "#'+this.name+'" will be validated',this);var a=this.getEvents();a&&a.onBeforeValidateField&&a.onBeforeValidateField(this),this.setValidating(i,e);return new Promise(async(t,i)=>{var n=this.getValue(),r=this.getRules(),l=!0;function o(e,t){return e.test(t)}for(const t of r){if(!l)break;await o(t,n).then(()=>{}).catch(t=>{l=!1,this._logger.log('validate(): Field "#'+this.name+'" is not valid',this),this.setInvalid(t,e),i()})}l&&(this._logger.log('validate(): Field "#'+this.name+'" is valid',this),this.setValid(s,e),t()),this._validator.updateDependencyRules(),this._validator.updateFormState(),a&&a.onValidateField&&a.onValidateField(this),this.$wrapper.dispatchEvent(new CustomEvent("formValidatorFieldValidate",{detail:{formValidatorField:this}}))})}}const x=(e,t,i)=>{var s;return null==t&&""==t&&(t=250),()=>{var a=arguments,n=i&&!s;clearTimeout(s),s=setTimeout((function(){s=null,i||e.apply(void 0,a)}),t),n&&e.apply(void 0,a)}};var k=w,P=d.DEFAULT_OPTIONS;const M=e=>(Object.keys(e).forEach(t=>{void 0===e[t]&&delete e[t]}),e);class B{static setDefaultOptions(e){P=Object(R.deepSpread)(e,P)}static setDefaultRules(e){e.forEach(e=>{if(!e.name)return!1;k[e.name]&&(e=Object(R.deepSpread)(e,k[e.name])),k[e.name]=e})}constructor(e,t={},i={}){this._logger=new I(t.debug),this._logger.log("constructor(): New validator instance");let s=Object(R.deepSpread)(i,P);return this.options=Object(R.deepSpread)(t,s),this.formId=e,document.getElementById(e)?(this._logger.log('constructor(): Validator will be initialized to "#'+e+'"'),!window.formValidator_instances&&(window.formValidator_instances={}),window.formValidator_instances[this.formId]&&window.formValidator_instances[this.formId].destroy(),window.formValidator_instances[this.formId]=this,this.init()):(this._logger.logError("constructor(): Couldn't find form element \"#"+e+'"'),!1)}init(){this._logger.log("init(): Initializing validator..."),this.initialized=!1,this.$form=document.getElementById(this.formId),this.fieldRenderPreferences=this.options.fieldRenderPreferences,this.events=this.options.events,this.validateFieldOnInput=this.options.validateFieldOnInput,this.validateFieldOnBlur=this.options.validateFieldOnBlur,this.validateFieldOnChange=this.options.validateFieldOnChange,this.resetFieldValidationOnChange=this.options.resetFieldValidationOnChange,this.submitFn=this.options.submitFn,this.showLoadingFn=this.options.showLoadingFn,this.hideLoadingFn=this.options.hideLoadingFn,this.formDisabledClass=this.options.formDisabledClass,this.formEnabledClass=this.options.formEnabledClass,this.groupWrapperHiddenClass=this.options.groupWrapperHiddenClass,this.groupWrapperVisibleClass=this.options.groupWrapperVisibleClass,this.enableDataRestore=this.options.enableDataRestore,this.submitting=!1,this.hasChangedSinceLastSubmission=!0,this.fields={},this._repeatables={},this.defaultRules=k,this.updateDependencyRules=x(()=>{this._logger.log("updateDependencyRules(): Updating...",this),this.eachField(e=>{let t=[];if(e.dependencyRules&&e.dependencyRules.length){let i=async(t,i)=>{var s=e.getValue(),a=[];function n(e,t){return e.test(t)}e.dependencyRules.forEach(t=>{if(t.name)if("isValid"===t.name){let i=e;t.fn=()=>i.isValid()}else if("isInvalid"===t.name){let i=e;t.fn=()=>!i.isValid()}else k[t.name]&&(Object.keys(t).forEach(e=>{void 0===t[e]&&delete t[e]}),t={...k[t.name],...M(t)});t.fields||(t.fields=[]),t.groups||(t.groups=[]),t.behavior&&t.behavior.length||(t.behavior="hide");let i=[new A(t),t];a.push(i)});for(const e of a){let t=e[0],i=e[1],a=this.getDependencyRuleTargetFields(i),r=()=>{i.groups.forEach(e=>{let t=this.getGroupWrapper(e);t&&(t.classList.add(this.groupWrapperHiddenClass),t.classList.remove(this.groupWrapperVisibleClass))}),a.forEach(e=>{let t=e.getFieldRenderPreferences();"hide"===i.behavior&&(e._hidden=!0,e.$wrapper.classList.add(t.wrapperHiddenClass),e.$wrapper.classList.remove(t.wrapperVisibleClass)),"disable"===i.behavior&&(e.disabled||e.disable()),e.disableRules()})},l=()=>{i.groups.forEach(e=>{let t=this.getGroupWrapper(e);t&&(t.classList.remove(this.groupWrapperHiddenClass),t.classList.add(this.groupWrapperVisibleClass))}),a.forEach(e=>{let t=e.getFieldRenderPreferences();"hide"===i.behavior&&(e._hidden=!1,e.$wrapper.classList.remove(t.wrapperHiddenClass),e.$wrapper.classList.add(t.wrapperVisibleClass)),"disable"===i.behavior&&(e.disabled||e.enable()),e.enableRules()})};await n(t,s).then(()=>{this.events.onBeforeShowDependentFields&&this.events.onBeforeShowDependentFields(e.targetFields),l(),this.events.onShowDependentFields&&this.events.onShowDependentFields(e.targetFields)}).catch(t=>{this.events.onBeforeHideDependentFields&&this.events.onBeforeHideDependentFields(e.targetFields),r(),this.events.onHideDependentFields&&this.events.onHideDependentFields(e.targetFields)})}t()};t.push(new Promise(i))}Promise.all(t).then(()=>{e.disabled&&e.disable(!1)}).catch(()=>{})}),this._onUpdate&&this._onUpdate()},150),this._logger.log("init(): Registering fields..."),this.options.fields.forEach(e=>{this.registerField(e)});let e={submit:e=>{e.preventDefault(),this.submit(e)},change:e=>{this.enableDataRestore&&this.updateFormState(),this.hasChangedSinceLastSubmission=!0,this.updateDependencyRules(!0)}};Object.keys(e).map(t=>{this.$form.addEventListener(t,e[t])}),this.enableDataRestore?(this.applyFormState(),this.updateFormState(),this.validate((function(e){this.updateDependencyRules()}))):this.resetForm(),delete this.options,delete this.formId,this.initialized=!0,this._logger.log("init(): Validator has been initialized",this),this.events.onInit&&this.events.onInit(this),this.destroy=()=>{this._logger.log("destroy(): Destroying validator..."),this.deleteFormState(),this.resetValidation(),this.eachField(e=>{e.unregister()}),Object.keys(e).map(t=>{this.$form.removeEventListener(t,e[t])}),this.initialized=!1}}registerField(e){this.fields[e.name]&&this.unregisterField(e.name);var t=this,i=e=>{e.name&&this.$form.querySelector('[name="'+e.name+'"]')?(e._validator=t,this.fields[e.name]=new D(e,this._logger.showLogs)):this._logger.logError("registerField(): Couldn't find a field with name '"+e.name+"'")};if("object"==typeof e.name)e.name.forEach(t=>{let s=e;s.name=t,i(s)});else{i(e)}}unregisterField(e){this.fields[e].unregister()}eachField(e){Object.keys(this.fields).forEach(t=>e(this.fields[t]))}isValid(e=[]){let t=!1;return e.length?e.forEach(e=>{this.fields[e]&&!this.fields[e].isValid()&&(t=!0)}):this.eachField(e=>{e&&!e.isValid()&&(t=!0)}),!t}getFirstInvalidField(e=[]){let t=void 0;return Object.keys(this.fields).every(i=>{let s=this.fields[i];return 0!==s._status||0!==e.length&&!e.includes(s.name)||(t=s,!1)}),t}getFirstNotValidField(e=[]){let t=void 0;return Object.keys(this.fields).every(i=>{let s=this.fields[i];return 1===s._status||0!==e.length&&!e.includes(s.name)||(t=s,!1)}),t}isValidating(){let e=!1;return this.eachField(t=>{-1===t._status&&(e=!0)}),e}getGroupWrapper(e){return this.$form.querySelector("["+d.GROUP_WRAPPER_DATA_ATTRIBUTE+'="'+e+'"]')}getGroupFields(e){var t=[];return this.eachField(i=>{i.group==e&&t.push(i)}),t}getFieldsByWrapperElement(e){var t=this;let i=[];if(e){let s=e.querySelectorAll("input,textarea,button,select");Array.from(s).map((function(e){let s=e.hasAttribute("name")?e.getAttribute("name"):void 0;s&&t.fields[s]&&i.push(t.fields[s])}))}return i}validate(e=[],t=(()=>{})){setTimeout(()=>{this._validate(e).then(e=>{t(!0)}).catch(e=>{t(!1)})},1)}_validate(e=[],t=!1){this._logger.log("validate(): Form will be validated"),this.events.onBeforeValidate&&this.events.onBeforeValidate(this);return new Promise((i,s)=>{let a=[];e.length?e.forEach(e=>{a.push(this.fields[e]._validate(t))}):this.eachField(e=>{a.push(e._validate(t))}),Promise.all(a).then(()=>{i()}).catch(()=>{s()}).finally(()=>{this.lastValidationSerializedFormData=this.getSerializedFormData(),this.events.onValidate&&this.events.onValidate(this)})})}resetValidation(e=[]){this.submitting||this.isValidating()||(e.length?e.forEach(e=>{this.fields[e].setUnvalidated()}):this.eachField(e=>{e.setUnvalidated()}),this.updateDependencyRules(),this._logger.log("resetForm(): Form validation has been reset"))}resetForm(){this.submitting||this.isValidating()||(this.events.onBeforeReset&&this.events.onBeforeReset(this),this.deleteFormState(),this.$form.reset(),this.resetValidation(),this._repeatables&&Object.keys(this._repeatables).forEach(e=>{let t=this._repeatables[e];for(let i=0;i<t;i++)this.removeRepeatable(e)}),this.eachField(e=>{e.formResetFn&&e.formResetFn(e)}),this._logger.log("resetForm(): Form has been reset"),this.events.onReset&&this.events.onReset(this))}deleteFormState(){window.localStorage["FORMVALIDATOR_FORMDATA_"+this.$form.getAttribute("id")]&&delete window.localStorage["FORMVALIDATOR_FORMDATA_"+this.$form.getAttribute("id")]}updateFormState(){let e={};Object.keys(this.fields).forEach(t=>{if(!this.fields[t])return;let i=this.fields[t];e[i.name]={_status:i._status,status:i.status,message:i.message}}),window.localStorage.setItem("FORMVALIDATOR_FORMDATA_"+this.$form.getAttribute("id"),JSON.stringify({data:this.getSerializedFormData(),repeatables:this._repeatables,validation:e}))}applyFormState(){let e=window.localStorage["FORMVALIDATOR_FORMDATA_"+this.$form.getAttribute("id")];if(e){let t=JSON.parse(e);if(t.repeatables&&Object.keys(t.repeatables).forEach(e=>{let i=t.repeatables[e];for(let t=0;t<i;t++)this.addRepeatable(e,!1)}),t.data){let e=t.data;this.eachField(t=>{let i="";void 0!==e[t.name]&&(i=e[t.name]),t.setValue(i)}),this.resetValidation(),this._validate([],!0).then(()=>{}).catch(()=>{})}}else this.resetValidation()}handlePreventingDefault(e){e.preventDefault()}disableForm(){this.eachField(e=>{e.disableInteraction()}),this.formDisabledClass&&this.formDisabledClass.length&&this.$form.classList.add(this.formDisabledClass),this.formEnabledClass&&this.formEnabledClass.length&&this.$form.classList.remove(this.formEnabledClass),this._logger.log("disableForm(): Form has been disabled")}enableForm(){this.eachField(e=>{e.enableInteraction()}),this.formDisabledClass&&this.formDisabledClass.length&&this.$form.classList.remove(this.formDisabledClass),this.formEnabledClass&&this.formEnabledClass.length&&this.$form.classList.add(this.formEnabledClass),this.$form.classList.add(),this._logger.log("enableForm(): Form has been enabled")}getDependencyRuleTargetFields(e){let t=[];return e.groups.forEach(e=>{this.getGroupFields(e).forEach(e=>{t.push(e)})}),e.fields.forEach(e=>{let i=this.fields[e];t.push(i)}),t}showLoading(){void 0!==this.showLoadingFn&&this.showLoadingFn(this)}hideLoading(){void 0!==this.hideLoadingFn&&this.hideLoadingFn(this)}getFormData(){return new FormData(this.$form)}getFieldsValues(){let e={};return this.eachField(t=>{e[t.name]=t.getValue()}),e}getSerializedFormData(){let e={};for(let[t,i]of this.getFormData())e[t]?(Array.isArray(e[t])||(e[t]=[e[t]]),e[t].push(i)):e[t]=i;return e}hasChangedSinceLastValidation(){return!this.lastValidationSerializedFormData||JSON.stringify(this.lastValidationSerializedFormData)!==JSON.stringify(this.getSerializedFormData())}_submit(){return new Promise((e,t)=>{this.submit(i=>{i?e():t()})})}submit(e){let t=()=>{if(this.events.onBeforeSubmit&&this.events.onBeforeSubmit(this),this._logger.log("submit(): Submitting form",this),this.$form.dispatchEvent(new CustomEvent("formValidatorSubmit",{detail:{formValidatorInstance:this}})),this.showLoading(),this.submitFn){this.disableForm();let t=t=>{this.submitting=!1,this.hideLoading(),t?(e&&e(!0),this.hasChangedSinceLastSubmission=!1,this.events.onSubmit&&this.events.onSubmit(this)):(this.submitting=!1,this._logger.log("submit(): Form can't be submitted",this),e&&e(!1),this.events.onSubmitFail&&this.events.onSubmitFail(this)),this.enableForm()};this.submitFn(this,t)}else this.submitting=!1,this.hideLoading(),this.$form.submit()(e&&e(!0)),this.hasChangedSinceLastSubmission=!1,this.events.onSubmit&&this.events.onSubmit(this)};this.events.onTrySubmit&&this.events.onTrySubmit(this);var i="function"==typeof e?e:()=>{};!0===this.submitting||this.isValidating()?i&&i(!1):(this.submitting=!0,this._validate().then(()=>{this.isValid()?t():this.submitting=(!1)(i&&i(!1))}).catch(()=>{this.submitting=!1,i&&i(!1)}))}getNodeChildrenFieldsNames(e){let t={},i=[];return Array.from(e.querySelectorAll("["+d.INITIALIZED_FIELD_DATA_ATTRIBUTE+"]")).forEach(e=>{e.hasAttribute("name")&&this.fields[e.getAttribute("name")]&&(t[e.getAttribute("name")]=!0)}),Object.keys(t).forEach(e=>{i.push(e)}),i}addRepeatable(e,t=!0){var i=document.querySelector("["+d.REPEATABLE_WRAPPER_DATA_ATTRIBUTE+'="'+e+'"]'),s=i.querySelectorAll("["+d.REPEATABLE_ITEM_DATA_ATTRIBUTE+"]")[0],a=i.querySelectorAll("["+d.REPEATABLE_ITEM_DATA_ATTRIBUTE+"]").length,n=Number(i.getAttribute(d.REPEATABLE_LIMIT_DATA_ATTRIBUTE));if(n>1&&a>=n)return;this._repeatables[e]=a;let r=this.getNodeChildrenFieldsNames(s),l=[],o=[];r.forEach(e=>{this.fields[e].removeValidationAppendedElements(),0===this.fields[e].status||1===this.fields[e].status||-1===this.fields[e].status?l.push(e):o.push(e)});let h=s.cloneNode(!0);r.forEach(e=>{let s=e+a;h.querySelectorAll('[name="'+e+'"]').forEach(e=>{e.setAttribute("id",e.getAttribute("id")+a),e.setAttribute("name",e.getAttribute("name")+a)}),h.querySelectorAll('label[for="'+e+'"]').forEach(e=>{e.hasAttribute("for")&&(e.setAttribute("for",e.getAttribute("for")+a),e.innerHTML=e.innerHTML+" ("+(a+1)+")")}),i.appendChild(h);this.registerField({...this.fields[e],name:s});t&&this.fields[s].setValue(""),this.fields[s].setUnvalidated()}),l.forEach(e=>{this.fields[e].validate()}),o.forEach(e=>{this.fields[e].setUnvalidated()}),this.updateFormState()}removeRepeatable(e,t=-1){var i=document.querySelector("["+d.REPEATABLE_WRAPPER_DATA_ATTRIBUTE+'="'+e+'"]').querySelectorAll("["+d.REPEATABLE_ITEM_DATA_ATTRIBUTE+"]");if(i.length<=1)return;let s;t=-1!==t?Number(t):i.length-1,s=this.getNodeChildrenFieldsNames(i[t]),s.forEach(e=>{this.unregisterField(e)}),i[t].remove(),this._repeatables[e]=this._repeatables[e]-1,this._repeatables[e]<1&&delete this._repeatables[e],this.updateFormState()}}class N{constructor(e){return this.steps=e.steps,this.currentStepIndex=void 0,this.disabledStepChange=!1,this.onUpdate=e.onUpdate,this.onInit=e.onInit,this.enableStrictStepsOrder=e.enableStrictStepsOrder,this.submitFn=e.submitFn,this.onBeforeSubmit=e.onBeforeSubmit,this.onTrySubmit=e.onTrySubmit,this.onSubmit=e.onSubmit,this.onSubmitFail=e.onSubmitFail,this.isSubmitting=!1,this.currentStepClass=e.currentStepClass||"d-block",this.hiddenStepClass=e.hiddenStepClass||"d-none",this.onSetStep=e.onSetStep,this.forceStepsSubmission=void 0===e.forceStepsSubmission||e.forceStepsSubmission,this.hasSubmittedStepsSinceLastSubmission=!0,this.init()}init(){for(let e=0;e<this.steps.length;e++){let t=this.steps[e],i=t.formValidatorInstance.$form,s=e=>{};t.formValidatorInstance._onUpdate=()=>{this.update()},t.formValidatorInstance&&t.formValidatorInstance.$form&&(i.addEventListener("change",s),t.formValidatorInstance.submitFn||(t.formValidatorInstance.submitFn=(e,t)=>{t(!0)}));let a=i.querySelectorAll("[data-steps-handler-previous]"),n=i.querySelectorAll("[data-steps-handler-next]"),r=i.querySelectorAll("[data-steps-handler-submit]");a.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),this.previous()})}),n.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),this.next()})}),r.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),this.submit()})});let l=e=>{this.hasSubmittedStepsSinceLastSubmission=!0};i.addEventListener("formValidatorSubmit",l)}return this.start(),this.update(),this.destroy=()=>{this.steps.forEach(e=>{e.formValidatorInstance.destroy()})},this.onInit&&this.onInit(this),this}hasChangedSinceLastSubmission(){let e=[];return this.steps.forEach(t=>{e.push(t.formValidatorInstance.hasChangedSinceLastSubmission)}),!(!1===e[0]&&(t=e,t.every(e=>!1===e)));var t}update(){for(let e=0;e<this.steps.length;e++){let t,i,s=this.steps[e],a=s.formValidatorInstance;t=a.isValid()?1:a.isValidating()?-1:0,i="function"==typeof s.enabled&&!s.enabled(),s._state={active:this.currentStepIndex===e,status:t,enabled:i}}this.onUpdate&&this.onUpdate(this)}focusStepFirstNotValidField(e){var t=this.steps[e].formValidatorInstance.getFirstNotValidField();t&&t.focus()}disableStepChange(){this.disabledStepChange=!0}enableStepChange(){this.disabledStepChange=!1}setStep(e,t=!0){if(e===this.currentStepIndex||this.disabledStepChange||e<0||e>=this.steps.length||!this.steps[e])return;let i=this;var s=this.currentStepIndex;this.disableStepChange();let a=()=>{this.enableStepChange(),s=this.currentStepIndex;for(const e of this.steps)e.formValidatorInstance.$form.classList.remove(this.currentStepClass),e.formValidatorInstance.$form.classList.add(this.hiddenStepClass);if(this.steps[e].formValidatorInstance.$form.classList.remove(this.hiddenStepClass),this.steps[e].formValidatorInstance.$form.classList.add(this.currentStepClass),this.currentStepIndex=e,this.update(),t&&this.focusStepFirstNotValidField(this.currentStepIndex),this.steps[e].formValidatorInstance.$form.dispatchEvent(new CustomEvent("formValidatorShowStep",{detail:{currentStep:e}})),this.onSetStep)return this.onSetStep(i,s)};if(void 0!==this.currentStepIndex&&this.enableStrictStepsOrder){let t=[];for(let i=0;i<e;i++)this.forceStepsSubmission?this.steps[i].formValidatorInstance.hasChangedSinceLastSubmission&&t.push(this.steps[i].formValidatorInstance._submit()):t.push(this.steps[i].formValidatorInstance._validate());Promise.all(t).then(()=>{e<this.currentStepIndex&&this.steps[this.currentStepIndex].formValidatorInstance.hasChangedSinceLastSubmission?this.steps[this.currentStepIndex].formValidatorInstance._validate().then(()=>{this.steps[this.currentStepIndex].formValidatorInstance.hasChangedSinceLastSubmission?this.steps[this.currentStepIndex].formValidatorInstance._submit().then(()=>{}).catch(()=>{}).finally(()=>{a()}):a()}).catch(()=>{a()}):a()}).catch(()=>{this.enableStepChange(),this.focusStepFirstNotValidField(this.currentStepIndex)})}else a()}next(){this.steps[this.currentStepIndex+1]?this.setStep(this.currentStepIndex+1):this.submit()}previous(){this.setStep(this.currentStepIndex-1)}reset(){for(let e=0;e<this.steps.length;e++){this.steps[e].formValidatorInstance.resetForm()}this.start()}start(){this.setStep(0,!1)}getFormDatas(){return this.steps.map(e=>e.formValidatorInstance.getFormData())}getSerializedFormDatas(e=!1){return this.steps.map(e=>e.formValidatorInstance.getSerializedFormData())}getStepsFieldsValues(){return this.steps.map(e=>e.formValidatorInstance.getFieldsValues())}getNotValidStepIndexes(){let e=[];for(let t=0;t<this.steps.length;t++){this.steps[t].formValidatorInstance.isValid()||e.push(t)}return e}submit(){if(this.onTrySubmit&&this.onTrySubmit(this),this.isSubmitting)return;let e=this.getNotValidStepIndexes();e.length&&this.steps[e[0]].formValidatorInstance._validate().then(()=>(this.submit(),!1)).catch(()=>{this.setStep(e[0]),this.focusStepFirstNotValidField(e[0])});let t=[];this.steps.forEach(e=>{e.formValidatorInstance.hasChangedSinceLastSubmission&&this.forceStepsSubmission&&t.push(e.formValidatorInstance._submit())}),Promise.all(t).then(()=>{let e=this;this.isSubmitting=!0,this.steps.forEach(e=>{e.formValidatorInstance.disableForm()}),this.onBeforeSubmit&&this.onBeforeSubmit(this),this.submitFn&&this.submitFn(this,t=>{e.isSubmitting=!1,this.hasSubmittedStepsSinceLastSubmission=!1,this.steps.forEach(e=>{e.formValidatorInstance.enableForm()}),t?(e.onBeforeSubmit&&e.onBeforeSubmit(e),e.onSubmit(e)):e.onSubmitFail(e)})}).catch(()=>{})}}var $=N;window.FormValidator=B,window.FormValidatorStepsHandler=$}]);